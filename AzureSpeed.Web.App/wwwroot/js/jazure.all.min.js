var CryptoJS=CryptoJS||function(n,t){var u={},f=u.lib={},o=function(){},i=f.Base={extend:function(n){o.prototype=this;var t=new o;return n&&t.mixIn(n),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var n=this.extend();return n.init.apply(n,arguments),n},init:function(){},mixIn:function(n){for(var t in n)n.hasOwnProperty(t)&&(this[t]=n[t]);n.hasOwnProperty("toString")&&(this.toString=n.toString)},clone:function(){return this.init.prototype.extend(this)}},r=f.WordArray=i.extend({init:function(n,i){n=this.words=n||[];this.sigBytes=i!=t?i:4*n.length},toString:function(n){return(n||l).stringify(this)},concat:function(n){var i=this.words,r=n.words,u=this.sigBytes,t;if(n=n.sigBytes,this.clamp(),u%4)for(t=0;t<n;t++)i[u+t>>>2]|=(r[t>>>2]>>>24-8*(t%4)&255)<<24-8*((u+t)%4);else if(65535<r.length)for(t=0;t<n;t+=4)i[u+t>>>2]=r[t>>>2];else i.push.apply(i,r);return this.sigBytes+=n,this},clamp:function(){var i=this.words,t=this.sigBytes;i[t>>>2]&=4294967295<<32-8*(t%4);i.length=n.ceil(t/4)},clone:function(){var n=i.clone.call(this);return n.words=this.words.slice(0),n},random:function(t){for(var i=[],u=0;u<t;u+=4)i.push(4294967296*n.random()|0);return new r.init(i,t)}}),e=u.enc={},l=e.Hex={stringify:function(n){var u=n.words,i,t,r;for(n=n.sigBytes,i=[],t=0;t<n;t++)r=u[t>>>2]>>>24-8*(t%4)&255,i.push((r>>>4).toString(16)),i.push((r&15).toString(16));return i.join("")},parse:function(n){for(var i=n.length,u=[],t=0;t<i;t+=2)u[t>>>3]|=parseInt(n.substr(t,2),16)<<24-4*(t%8);return new r.init(u,i/2)}},s=e.Latin1={stringify:function(n){var r=n.words,i,t;for(n=n.sigBytes,i=[],t=0;t<n;t++)i.push(String.fromCharCode(r[t>>>2]>>>24-8*(t%4)&255));return i.join("")},parse:function(n){for(var i=n.length,u=[],t=0;t<i;t++)u[t>>>2]|=(n.charCodeAt(t)&255)<<24-8*(t%4);return new r.init(u,i)}},a=e.Utf8={stringify:function(n){try{return decodeURIComponent(escape(s.stringify(n)))}catch(t){throw Error("Malformed UTF-8 data");}},parse:function(n){return s.parse(unescape(encodeURIComponent(n)))}},h=f.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new r.init;this._nDataBytes=0},_append:function(n){"string"==typeof n&&(n=a.parse(n));this._data.concat(n);this._nDataBytes+=n.sigBytes},_process:function(t){var f=this._data,s=f.words,u=f.sigBytes,e=this.blockSize,o=u/(4*e),o=t?n.ceil(o):n.max((o|0)-this._minBufferSize,0),i;if(t=o*e,u=n.min(4*t,u),t){for(i=0;i<t;i+=e)this._doProcessBlock(s,i);i=s.splice(0,t);f.sigBytes-=u}return new r.init(i,u)},clone:function(){var n=i.clone.call(this);return n._data=this._data.clone(),n},_minBufferSize:0}),c;return f.Hasher=h.extend({cfg:i.extend(),init:function(n){this.cfg=this.cfg.extend(n);this.reset()},reset:function(){h.reset.call(this);this._doReset()},update:function(n){return this._append(n),this._process(),this},finalize:function(n){return n&&this._append(n),this._doFinalize()},blockSize:16,_createHelper:function(n){return function(t,i){return new n.init(i).finalize(t)}},_createHmacHelper:function(n){return function(t,i){return new c.HMAC.init(n,i).finalize(t)}}}),c=u.algo={},u}(Math);(function(){var n=CryptoJS,t=n.lib.WordArray;n.enc.Base64={stringify:function(n){var i=n.words,u=n.sigBytes,f=this._map,t,e,r;for(n.clamp(),n=[],t=0;t<u;t+=3)for(e=(i[t>>>2]>>>24-8*(t%4)&255)<<16|(i[t+1>>>2]>>>24-8*((t+1)%4)&255)<<8|i[t+2>>>2]>>>24-8*((t+2)%4)&255,r=0;4>r&&t+.75*r<u;r++)n.push(f.charAt(e>>>6*(3-r)&63));if(i=f.charAt(64))for(;n.length%4;)n.push(i);return n.join("")},parse:function(n){var e=n.length,f=this._map,i=f.charAt(64),o,s;i&&(i=n.indexOf(i),-1!=i&&(e=i));for(var i=[],u=0,r=0;r<e;r++)r%4&&(o=f.indexOf(n.charAt(r-1))<<2*(r%4),s=f.indexOf(n.charAt(r))>>>6-2*(r%4),i[u>>>2]|=(o|s)<<24-8*(u%4),u++);return t.create(i,u)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}})();CryptoJS=CryptoJS||function(n,t){var u={},f=u.lib={},o=function(){},i=f.Base={extend:function(n){o.prototype=this;var t=new o;return n&&t.mixIn(n),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var n=this.extend();return n.init.apply(n,arguments),n},init:function(){},mixIn:function(n){for(var t in n)n.hasOwnProperty(t)&&(this[t]=n[t]);n.hasOwnProperty("toString")&&(this.toString=n.toString)},clone:function(){return this.init.prototype.extend(this)}},r=f.WordArray=i.extend({init:function(n,i){n=this.words=n||[];this.sigBytes=i!=t?i:4*n.length},toString:function(n){return(n||l).stringify(this)},concat:function(n){var i=this.words,r=n.words,u=this.sigBytes,t;if(n=n.sigBytes,this.clamp(),u%4)for(t=0;t<n;t++)i[u+t>>>2]|=(r[t>>>2]>>>24-8*(t%4)&255)<<24-8*((u+t)%4);else if(65535<r.length)for(t=0;t<n;t+=4)i[u+t>>>2]=r[t>>>2];else i.push.apply(i,r);return this.sigBytes+=n,this},clamp:function(){var i=this.words,t=this.sigBytes;i[t>>>2]&=4294967295<<32-8*(t%4);i.length=n.ceil(t/4)},clone:function(){var n=i.clone.call(this);return n.words=this.words.slice(0),n},random:function(t){for(var i=[],u=0;u<t;u+=4)i.push(4294967296*n.random()|0);return new r.init(i,t)}}),e=u.enc={},l=e.Hex={stringify:function(n){var u=n.words,i,t,r;for(n=n.sigBytes,i=[],t=0;t<n;t++)r=u[t>>>2]>>>24-8*(t%4)&255,i.push((r>>>4).toString(16)),i.push((r&15).toString(16));return i.join("")},parse:function(n){for(var i=n.length,u=[],t=0;t<i;t+=2)u[t>>>3]|=parseInt(n.substr(t,2),16)<<24-4*(t%8);return new r.init(u,i/2)}},s=e.Latin1={stringify:function(n){var r=n.words,i,t;for(n=n.sigBytes,i=[],t=0;t<n;t++)i.push(String.fromCharCode(r[t>>>2]>>>24-8*(t%4)&255));return i.join("")},parse:function(n){for(var i=n.length,u=[],t=0;t<i;t++)u[t>>>2]|=(n.charCodeAt(t)&255)<<24-8*(t%4);return new r.init(u,i)}},a=e.Utf8={stringify:function(n){try{return decodeURIComponent(escape(s.stringify(n)))}catch(t){throw Error("Malformed UTF-8 data");}},parse:function(n){return s.parse(unescape(encodeURIComponent(n)))}},h=f.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new r.init;this._nDataBytes=0},_append:function(n){"string"==typeof n&&(n=a.parse(n));this._data.concat(n);this._nDataBytes+=n.sigBytes},_process:function(t){var f=this._data,s=f.words,u=f.sigBytes,e=this.blockSize,o=u/(4*e),o=t?n.ceil(o):n.max((o|0)-this._minBufferSize,0),i;if(t=o*e,u=n.min(4*t,u),t){for(i=0;i<t;i+=e)this._doProcessBlock(s,i);i=s.splice(0,t);f.sigBytes-=u}return new r.init(i,u)},clone:function(){var n=i.clone.call(this);return n._data=this._data.clone(),n},_minBufferSize:0}),c;return f.Hasher=h.extend({cfg:i.extend(),init:function(n){this.cfg=this.cfg.extend(n);this.reset()},reset:function(){h.reset.call(this);this._doReset()},update:function(n){return this._append(n),this._process(),this},finalize:function(n){return n&&this._append(n),this._doFinalize()},blockSize:16,_createHelper:function(n){return function(t,i){return new n.init(i).finalize(t)}},_createHmacHelper:function(n){return function(t,i){return new c.HMAC.init(n,i).finalize(t)}}}),c=u.algo={},u}(Math),function(n){for(var r,a,s,t,f=CryptoJS,i=f.lib,v=i.WordArray,e=i.Hasher,i=f.algo,h=[],c=[],l=function(n){return 4294967296*(n-(n|0))|0},o=2,u=0;64>u;){n:{for(r=o,a=n.sqrt(r),s=2;s<=a;s++)if(!(r%s)){r=!1;break n}r=!0}r&&(8>u&&(h[u]=l(n.pow(o,.5))),c[u]=l(n.pow(o,1/3)),u++);o++}t=[];i=i.SHA256=e.extend({_doReset:function(){this._hash=new v.init(h.slice(0))},_doProcessBlock:function(n,i){for(var o,s,r=this._hash.words,f=r[0],h=r[1],l=r[2],y=r[3],e=r[4],a=r[5],v=r[6],p=r[7],u=0;64>u;u++)16>u?t[u]=n[i+u]|0:(o=t[u-15],s=t[u-2],t[u]=((o<<25|o>>>7)^(o<<14|o>>>18)^o>>>3)+t[u-7]+((s<<15|s>>>17)^(s<<13|s>>>19)^s>>>10)+t[u-16]),o=p+((e<<26|e>>>6)^(e<<21|e>>>11)^(e<<7|e>>>25))+(e&a^~e&v)+c[u]+t[u],s=((f<<30|f>>>2)^(f<<19|f>>>13)^(f<<10|f>>>22))+(f&h^f&l^h&l),p=v,v=a,a=e,e=y+o|0,y=l,l=h,h=f,f=o+s|0;r[0]=r[0]+f|0;r[1]=r[1]+h|0;r[2]=r[2]+l|0;r[3]=r[3]+y|0;r[4]=r[4]+e|0;r[5]=r[5]+a|0;r[6]=r[6]+v|0;r[7]=r[7]+p|0},_doFinalize:function(){var r=this._data,t=r.words,u=8*this._nDataBytes,i=8*r.sigBytes;return t[i>>>5]|=128<<24-i%32,t[(i+64>>>9<<4)+14]=n.floor(u/4294967296),t[(i+64>>>9<<4)+15]=u,r.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var n=e.clone.call(this);return n._hash=this._hash.clone(),n}});f.SHA256=e._createHelper(i);f.HmacSHA256=e._createHmacHelper(i)}(Math),function(){var n=CryptoJS,t=n.enc.Utf8;n.algo.HMAC=n.lib.Base.extend({init:function(n,i){var u,f;n=this._hasher=new n.init;"string"==typeof i&&(i=t.parse(i));u=n.blockSize;f=4*u;i.sigBytes>f&&(i=n.finalize(i));i.clamp();for(var e=this._oKey=i.clone(),o=this._iKey=i.clone(),s=e.words,h=o.words,r=0;r<u;r++)s[r]^=1549556828,h[r]^=909522486;e.sigBytes=o.sigBytes=f;this.reset()},reset:function(){var n=this._hasher;n.reset();n.update(this._iKey)},update:function(n){return this._hasher.update(n),this},finalize:function(n){var t=this._hasher;return n=t.finalize(n),t.reset(),t.finalize(this._oKey.clone().concat(n))}})}(),function(n,t){var i=function(){return new i.fn.init};i.prototype={init:function(){return this}};$.extend(i,{maxThread:7,protocol:"https",ajax:function(n){$.ajax({url:n.url,type:n.type,data:n.data,dataType:n.dataType,ifModified:!0,headers:n.headers,cache:!0,processData:!1,xhr:function(){var t=$.ajaxSettings.xhr();return t.upload&&n.progress&&t.upload.addEventListener("progress",function(t){n.progress(t)},!1),t},beforeSend:function(t){n.before&&n.before(t)},success:function(t,i,r){$.isXMLDoc(t)&&(t=$.xml2json(t));n.convertor&&(t=n.convertor(t));n.success&&(n.object?n.success.call(n.object,t,i,r):n.success(t,i,r))},error:function(t,i,r){n.error&&(n.object?n.error.call(n.object,i,r):n.error(i,r))}})},getResponseHeaders:function(n,t,i){var u=n.getAllResponseHeaders(),r={},t=t||"";return i===undefined&&(i=!0),u&&$.each(u.split("\r\n"),function(){var u=this.valueOf(),n;u&&(!t||u.indexOf(t)==0)&&(n=u.split(":"),i?r[n[0].substring(t.length)]=n[1].trim():r[n[0]]=n[1].trim())}),r},setMaxThread:function(n){!isNaN(n)&&n>=0&&(this.maxThread=parseInt(n))},setBlockSize:function(n){if(!isNaN(n)){var t=parseInt(n);this.blockSize=Math.max(1,Math.min(t,maxBlockSize))}},defineReadonlyProperties:function(n,t){for(var i in t)Object.defineProperty(n,i,{value:t[i],writable:!1,configurable:!1,enumerable:!0})}});i.prototype.init.prototype=i.prototype;i.fn=i.prototype;t.jAzure=i;t.ja||(t.ja=i)}(jQuery,window),function(n,t){function h(n){var i=new RegExp("http[s]?://[^/]*/([^?]*)"),t=i.exec(n);return t&&t[1].length>0?t[1]:"/"}function c(n){for(var i=new RegExp("([^&?=]+)=([^=&]*)","g"),r=[],t=i.exec(n);t;)r.push({name:t[1],value:t[2]}),t=i.exec(n);return r}function l(n){var t=[];for(var r in n)r.indexOf("x-ms-")==0&&t.push({name:r.toLowerCase(),value:n[r].trim(),toString:function(){return this.name+":"+this.value.trim().replace(/\r\n/g,"")}});return t.sort(function(n,t){return n.name>t.name?1:-1}),t.join(i.newLineChar)}function a(n,t,r){var u=["/",t],o=h(n),e,l,s,f;if(o=o.replace(t+"-secondary",t),o&&(o!="/"&&u.push("/"),u.push(encodeURI(o))),e=c(n),r)for(s=e.length,s>0&&u.push(i.newLineChar),f=0;f<s;f++)e[f].name=="comp"&&(u.push("?comp="),u.push(e[f].value));else for(e.sort(function(n,t){return n.name.toLowerCase()>t.name.toLowerCase()?1:-1}),s=e.length,f=0;f<s;f++)l=e[f],u.push(i.newLineChar),u.push(l.name.toLowerCase()),u.push(":"),u.push(encodeURI(l.value));return u.join("")}function v(n,t){for(var u,f=n.isSharedKeyLiteOrTableService?["Content-MD5","Content-Type","Date"]:["Content-Encoding","Content-Language","Content-Length","Content-MD5","Content-Type","Date","If-Modified-Since","If-Match","If-None-Match","If-Unmodified-Since","Range"],i=[n.type],e=f.length,r=0;r<e;r++)u=n.headers[f[r]],i.push(u!=undefined?u:"");return(n.isSharedKeyLiteOrTableService||n.type!="PUT")&&n.type!="DELETE"&&n.type!="HEAD"||(i[3]=n.data?n.data.length:0),i.push(l(n.headers)),i.push(a(n.url,t,n.isSharedKeyLiteOrTableService)),i}function y(n){var i=!f.test(n.type),t=n.url;return!i&&n.data&&(t+=(e.test(t)?"&":"?")+n.data),t}function p(n){n.headers=n.headers||{};var r=y(n);n.ifModified&&(t.lastModified[r]&&(n.headers["If-Modified-Since"]=t.lastModified[r]),t.etag[r]&&(n.headers["If-None-Match"]=t.etag[r]));n.headers["x-ms-version"]=i.x_ms_version;n.headers["x-ms-date"]=(new Date).toGMTString();n.headers["Content-Type"]&&(n.contentType=n.headers["Content-Type"])}function w(n){var i=n.url,t,r;if(n.params){t=[];for(r in n.params)t.push(r+"="+n.params[r]);i+=i.indexOf("?")>0?"&"+t.join("&"):"?"+t.join("&");n.url=i}}function u(n){var t=String(n);return t.length===1&&(t="0"+t),t}function b(n){return n.getUTCFullYear()+"-"+u(n.getUTCMonth()+1)+"-"+u(n.getUTCDate())+"T"+u(n.getUTCHours())+":"+u(n.getUTCMinutes())+":"+u(n.getUTCSeconds())+"Z"}function o(n,i,r,u,f){f&&t.extend(this,f);this.web=n;this.type=r;this.url=i;this.params=u}var s=n,i={newLineChar:"\n",x_ms_version:"2013-08-15",blockSize:4194304,serviceEndpoint:"core.windows.net",splitUrl:function(n){var i=new RegExp("(http[s]?://([^.]+).[^/]*)/([^?/]*)/?([^?]*)(.*)","g"),t=i.exec(n);if(!t)throw"invalid blob url.";return{endpoint:t[1],accountName:t[2],containerName:t[3],blobName:t[4],sas:t[5]}},joinUrl:function(){var n=new RegExp("([^:])/{2,}","g");return Array.prototype.slice.call(arguments).join("/").replace(n,"$1/")}},f,e,r;n.storage=i;f=/^(?:GET|HEAD)$/;e=/\?/;r=function(n,t){return new r.prototype.init(n,t)};r.prototype={init:function(n,t){var r=n&&t?{accountName:n,sharedKey:t}:null;this.sendRequest=function(t){if(w(t),t.ifModified=!0,p(t),r){var i=v(t,r.accountName),u=this.compute256(i),f=(t.isSharedKeyLiteOrTableService?"SharedKeyLite":"SharedKey")+" "+n+":"+u;t.headers.Authorization=f}s.ajax(t)};this.compute256=function(n){var r=CryptoJS.enc.Utf8.parse(n.join(i.newLineChar)),u=CryptoJS.enc.Base64.parse(t),f=CryptoJS.HmacSHA256(r,u);return f.toString(CryptoJS.enc.Base64)}},request:function(n,t,i,r){return new o(this,n,t,i,r)},getSas:function(n){var r={permission:"",startTime:"",endTime:"",resourceName:"",policyIdentifier:"",storageVersion:i.x_ms_version,cacheControl:"",contentDisposition:"",contentEncoding:"",contentLanguage:"",contentType:""},f=[],o,t,e,u;for(t in r)n[t]?(u=n[t],(t=="startTime"||t=="endTime")&&(n[t]instanceof Date||(u=new Date(n[t])),u=b(u)),f.push(u),r[t]=u):f.push(r[t]);r.signature=this.compute256(f);r.resourceType=n.resourceType;o={sv:"storageVersion",sr:"resourceType",si:"policyIdentifier",sk:"accountKeyName",sig:"signature",st:"startTime",se:"endTime",sp:"permission",rscc:"cacheControl",rsct:"contentType",rsce:"contentEncoding",rscl:"contentLanguage",rscd:"contentDisposition"};f.length=0;for(t in o)e=o[t],r[e]&&(u=r[e],f.push(t+"="+encodeURIComponent(r[e])));return"?"+f.join("&")}};r.prototype.init.prototype=r.prototype;o.prototype={send:function(n,t){n&&(this.success=n);t&&(this.error=t);this.web.sendRequest(this)}};n.storage.web=r}(jAzure,jQuery,window),function(n,t){var r=n,f=r.storage,e=r.storage.web,u=function(n,t,i){return r.protocol+"://"+t+"."+n+"."+(i||f.serviceEndpoint)+"/"},i=function(n,t,r){return new i.prototype.init(n,t,r)};i.prototype.init=function(n,t,i){return r.defineReadonlyProperties(this,{Name:n,BlobUrl:u("blob",n,i),TableUrl:u("table",n,i),QueueUrl:u("queue",n,i),web:e(n,t)}),this};i.prototype.init.prototype=i.prototype;t.extend(i.prototype,{getBlobServiceProperties:function(n,t){this.web.request(this.BlobUrl,"GET",{restype:"service",comp:"properties"}).send(n,t)},setBlobServiceProperties:function(n,i,r){var u=t.json2xml({StorageServiceProperties:n});this.web.request(this.BlobUrl,"PUT",{restype:"service",comp:"properties"},{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:u,success:i,error:r}).send()},getBlobServiceStats:function(n,t){this.web.request(this.BlobUrl,"GET",{restype:"service",comp:"stats"}).send(n,t)}});r.storage.account=i}(jAzure,jQuery,window),function(t,i){var r=t,s=r.storage,o=r.storage.web;i.extend(r.storage.account.prototype,{getContainer:function(n){var t=u(null);return r.defineReadonlyProperties(t,{Name:n,Url:this.BlobUrl+n}),t.web=this.web,t},listContainers:function(n,t,r){var f=i.extend({},n,{comp:"list"}),u=this,e=function(n){var e=[],t=n.Containers.Container,o,f,r;if(i.isArray(t))for(o=t.length,f=0;f<o;f++)r=u.getContainer(t[f].Name),r.Properties=t[f].Properties,e.push(r);else r=u.getContainer(t.Name),r.Properties=t.Properties,e.push(r);return e};this.web.request(this.BlobUrl,"GET",f,{convertor:e,success:t,error:r}).send()}});var u=function(n){return new u.prototype.init(n)},f="x-ms-meta-",e={Etag:"ETag",Last_Modified:"Last-Modified",LeaseState:"x-ms-lease-state",LeaseStatus:"x-ms-lease-status",LeaseDuration:"x-ms-lease-duration"};u.prototype={init:function(n){return r.defineReadonlyProperties(this,{SAS:n}),n&&n.indexOf("http")==0&&r.defineReadonlyProperties(this,{Url:n}),this.web=o(n),this},getSas:function(n){surl=r.storage.splitUrl(this.Url);var t=i.extend({},n,{resourceType:"c",resourceName:"/"+r.storage.joinUrl(surl.accountName,surl.containerName)});return this.web.getSas(t)},getSasUri:function(n){var i=this.getSas(n),t=r.storage.splitUrl(this.Url);return r.storage.joinUrl(t.endpoint,t.containerName)+i},create:function(n,t){this.web.request(this.Url,"PUT",{restType:"container"}).send(n,t)},"delete":function(){},getProperties:function(n,t){var i=this;i.web.request(this.Url,"GET",{restype:"container"}).send(function(t,r,u){var f={};for(var o in e)f[o]=u.getResponseHeader(e[o]);i.Properties=f;n&&n.call(i,i.Properties)},t)},getMetadata:function(n,t){var i=this;i.web.request(this.Url,"GET",{restype:"container",comp:"metadata"},{success:function(t,r,u){i.Metadata=u.getResponseHeaders(f);n&&n.call(i,i.Metadata)},error:t}).send()},setMetadata:function(t,i,r){if(t){var u=this;u.web.reqeust(this.Url,"PUT",{restype:"container",comp:"metadata"},{before:function(i){for(n in t)i.setRequestHeader(f+n,t[n])},success:i,error:r}).send()}},getACL:function(n,t){var i=this;i.web.request(this.Url,"GET",{restype:"container",comp:"acl"},{success:function(t,r,u){var f={};f.PublicAccess=u.getResponseHeader("x-ms-blob-public-access");f.SignedIdentifiers=t;i.ACL=f;n&&n.call(i,i.ACL)},error:t}).send()},setACL:function(n,t,r){if(n){var u={"Content-Type":", text/plain;charset=UTF-8"};n.PublicAccess&&(u["x-ms-blob-public-access"]=n.PublicAccess);this.web.request(this.Url,"PUT",{restype:"container",comp:"acl"},{headers:u,data:i.json2xml({SignedIdentifiers:n.SignedIdentifiers}),success:t,error:r}).send()}},lease:function(){alert("lease is comming...")}};u.prototype.init.prototype=u.prototype;t.storage.container=u}(jAzure,jQuery,window),function(t,i){function g(n,t){for(var i=""+n;i.length<t;)i="0"+i;return i}var l="PageBlob",o="BlockBlob",r=t,w=r.storage,c=r.storage.container,y=r.storage.web,b=function(n,t){var u,o,s,r;if(t){for(u=[],i.isArray(t)||(t=[t]),o=n instanceof c?"":n.FullName,s=t.length,r=0;r<s;r++){var f=t[r],h=f.Name.substring(o.length),e=n.getBlob(h,f.Properties.BlobType);e.Properties=f.Properties;e.web=n.web;u.push(e)}return u}return[]},k=function(n,t){var o,c,r,u,l,s;if(t){for(o=[],i.isArray(t)||(t=[t]),c=t.length,r=h(n.Url),u=0;u<c;u++)l=f(r.endpoint,r.containerName,t[u].Name,r.sas),s=e(l),s.web=n.web,o.push(s);return o}return[]},h=r.storage.splitUrl,f=r.storage.joinUrl,d=function(n){var i,t;if(!n)return n;for(i=["B","KB","MB","GB","TB","PB"],typeof n=="string"&&(n=parseInt(n)),t=0;t<i.length;t++){if(n<1024)return n.toFixed(2)+i[t];n=n/1024}return n},e,v,u;i.extend(c.prototype,{listBlobs:function(n,t,i){typeof n=="function"&&(i=t,t=n,n=null);n=n||{};n.restype="container";n.comp="list";var r=this,u=function(n){var t={};return t.blobs=b(r,n.Blobs.Blob),t.directories=k(r,n.Blobs.BlobPrefix),t.nextMarker=n.NextMarker,t.prefix=n.Prefix,t};this.web.request(this.Url,"GET",n,{convertor:u,success:t,error:i}).send()},children:function(n,t,r){return typeof n=="function"&&(r=t,t=n,n={}),i.extend(n,{delimiter:"/"}),this.listBlobs.call(this,n,t,r)},getDirectory:function(n){var t=h(this.Url),i;return url=f(t.endpoint,t.containerName,n+t.sas),i=e(url),i.web=this.web,i},getBlob:function(n,t){if(t||(t=o),t!=l&&t!=o)throw"the blob type can only be "+o+" or "+l+", by default is "+o+".";var i=h(this.Url),u=f(i.endpoint,i.containerName,n+i.sas),r=s(u,t);return r.web=this.web,r},getBlockBlob:function(n){return this.getBlob(n,o)},getPageBlob:function(n){return this.getPageBlob(n,l)}});e=function(n){return new e.prototype.init(n)};e.prototype={init:function(n){var t=h(n),i=t.blobName,n=f(t.endpoint,t.containerName,t.sas),u=i.replace(/^\/|\/?$/g,""),e=u.substring(u.lastIndexOf("/")+1);return r.defineReadonlyProperties(this,{Url:n,Name:e,FullName:i}),this.web=y(),this},getBlob:function(n,t){return n=f(this.FullName,n),c.prototype.getBlob.call(this,n,t)},getBlockBlob:function(n){return this.getBlob(n,o)},getPageBlob:function(n){return this.getBlob(n,l)},listBlobs:function(n,t,r){var u={};return typeof n=="object"?i.extend(u,n):typeof n=="function"&&(r=t,t=n),u.prefix=f(this.FullName,u.prefix||""),c.prototype.listBlobs.call(this,u,t,r)},getDirectory:function(n){return n=f(this.FullName,n,"/"),c.prototype.getDirectory.call(this,n)},children:function(n,t,r){var u={};return typeof n=="object"?i.extend(u,n):typeof n=="function"&&(r=t,t=n),u.delimiter="/",this.listBlobs(u,t,r)},parent:function(){var t=this.FullName.replace(/^\/|\/?$/g,"");if(t.indexOf("/")<0)return null;var n=h(this.Url),i=t.split("/"),u=i.slice(0,i.length-1).join("/"),o=f(n.endpoint,n.containerName,u,n.sas),r=e(o);return r.web=this.web,r}};e.prototype.init.prototype=e.prototype;var s=function(n,t){return new s.prototype.init(n,t)},p="x-ms-meta-",a={BlobType:"x-ms-blob-type",Cache_Control:"Cache-Control",Content_Disposition:"Content-Disposition",Content_Encoding:"Content-Encoding",Content_Language:"Content-Language",Content_Length:"Content-Length",Content_MD5:"Content-MD5",Content_Type:"Content-Type",Etag:"Etag",Last_Modified:"Last-Modified",LeaseState:"x-ms-lease-state",LeaseStatus:"x-ms-lease-status"};s.prototype={init:function(n,t){var f=h(n),u=f.blobName,i=u.substring(u.lastIndexOf("/")+1),e=i.indexOf(".")>=0?i.substring(i.lastIndexOf(".")+1):"";return r.defineReadonlyProperties(this,{Url:n,BlobType:t,Name:i,FullName:u,Extension:e}),f.sas&&r.defineReadonlyProperties(this,{sas:n}),this.web=y(),this},getSas:function(n){surl=r.storage.splitUrl(this.Url);var t=i.extend({},n,{resourceType:"b",resourceName:"/"+r.storage.joinUrl(surl.accountName,surl.containerName,this.FullName)});return this.web.getSas(t)},getSasUri:function(n){var i=this.getSas(n),t=r.storage.splitUrl(this.Url);return r.storage.joinUrl(t.endpoint,t.containerName,this.FullName)+i},size:function(n){var t=parseInt(this.Properties.Content_Length,10);return n===!1?t:d(t)},put:function(n,t,i){this.upload(n,null,null,t,i)},get:function(){this.download()},snapshot:function(t,i,r){typeof t=="function"&&(r=i,i=t,t=null);var u={};if(t)for(n in t)u["x-ms-meta-"+n]=t[n];this.web.request(this.Url,"PUT",{comp:"snapshot"},{headers:u,success:i,error:r}).send()},copy:function(t,i,r,u){var f,e,o;if(typeof i==r&&(u=r,r=i,i=null),f={"x-ms-copy-source":t},i)for(n in i)if(n=="metadata"){e=i[n];for(m in e)f["x-ms-meta-"+m]=e[m]}else f[n]=i[n];o=this;o.web.request(this.Url,"PUT",null,{headers:f,success:function(n,t,i){return{copyId:i.getResponseHeader("x-ms-copy-id"),copyStatus:i.getResponseHeader("x-ms-copy-status")}},error:u}).send()},abortCopy:function(n,t,i){this.web.request(this.Url,"PUT",{comp:"copy",copyid:n},{headers:{"x-ms-copy-action":"abort"},success:t,error:i}).send()},getBlockList:function(n,t,i,r){if(typeof n=="function"?(i=n,r=t,n="committed",t=null):typeof t=="function"&&(r=i,i=t,t=0),this.BlobType!=o)throw"The function only available for block blob";if(["committed","uncommitted","all"].indexOf(n)==-1)throw'The block list type can only be "committed","uncommitted" or "all".';var u={comp:"blocklist",blocklisttype:n};t&&(u.snapshot=t);this.web.request(this.Url,"GET",u).send(i,r)},getPageRanges:function(){},upload:function(n,t,r,f,e){var o=arguments.length;o==2||o==3?(f=t,e=r):o==4&&(f=t,e=f,r=t);n instanceof File||(n=i.isArray(n)?new Blob(n):typeof n=="object"?new Blob([JSON.stringify(n)]):new Blob([n]));u.enqueueBlob(this,n,t,r,f,e);u.enqueueErrorBlocks(s);u.upload()},download:function(){var t="ja-blob-download-frame-",n=document.getElementById(t);if(n==null&&(n=document.createElement("iframe"),n.id=t,n.style.display="none",document.body.appendChild(n)),this.sas)n.src=this.sas;else{var i=new Date,r=new Date(i.getTime()-3e5),u=new Date(i.getTime()+18e4);n.src=this.getSasUri({permission:"r",startTime:r,endTime:u})}},"delete":function(n,t){this.web.request(this.Url,"DELETE").send(n,t)},setMetadata:function(t,i,r){if(t){var u={};for(n in t)u[p+n]=t[n];this.web.request(this.Url,"PUT",{comp:"metadata"},{headers:u,success:i,error:r}).send()}},setProperties:function(t,i,r){if(t){var u={};for(n in t)u[a[n]]=t[n];this.web.request(this.Url,"PUT",{comp:"properties"},{headers:u,success:i,error:r}).send()}},getMetadata:function(n,t){var i=this;i.web.request(this.Url,"GET",{comp:"metadata"},{before:function(){},success:function(t,u,f){i.Metadata=r.getResponseHeaders(f,p);n&&n.call(i,i.Metadata)},error:t}).send()},getProperties:function(n,t){var i=this;i.web.request(this.Url,"HEAD",null,{success:function(t,r,u){var f={};for(var e in a)f[e]=u.getResponseHeader(a[e]);i.Properties=f;n&&n.call(i,i.Properties)},error:t}).send()}};s.prototype.init.prototype=s.prototype;v=function(n){this.cp=n;this.pointer=n.pointer;this.content=n.file.slice(this.pointer,this.pointer+r.storage.blockSize);this.id=btoa("block-"+g(n.blocks.length,6)).replace(/=/g,"a");this.size=this.content.size;this.loaded=0};v.prototype={upload:function(){var t=this,i=new FileReader,n=this.cp,r=n.blob.web;i.onloadend=function(i){if(i.target.readyState==FileReader.DONE){var f=new Uint8Array(i.target.result);r.request(n.blob.Url,"PUT",{comp:"block",blockid:t.id},{data:f,processData:!1,headers:{"x-ms-blob-type":n.blob.BlobType,"Content-Type":n.type},before:function(){n.send||n.before&&n.before.apply(n.blob,arguments);n.send=!0},progress:function(i){n.loaded+=i.loaded-t.loaded;t.loaded=i.loaded;n.progress&&n.progress.call(n.blob,{loaded:n.loaded,total:n.size})},success:function(){n.loaded==n.size&&u.commit(n);u.threads--;u.upload()},error:function(){n.loaded-=t.loaded;n.errorBlocks.push(t);n.error&&n.error.apply(n.blob,arguments);u.threads--;u.upload()}}).send()}};i.readAsArrayBuffer(t.content)}};u={blobQueue:{},blockQueue:[],threads:0,enqueueBlob:function(n,t,i,r,u,f){if(!this.blobQueue[n.Url]){var e={};e.blob=n;e.send=!1;e.pointer=0;e.file=t;e.size=t.size;e.loaded=0;e.type=t.type;e.before=i;e.progress=r;e.success=u;e.error=f;e.blocks=[];e.errorBlocks=[];this.blobQueue[n.Url]=e}},hasBlob:function(n){return!!this.blobQueue[n.Url]},dequeueBlob:function(n){delete this.blobQueue[n.Url]},enqueueErrorBlocks:function(n){var i=this.blobQueue[n.Url],t;i&&(t=i.errorBlocks.shift(),t&&this.blockQueue.push(t))},enqueueAllErrorBlocks:function(){var n,t;for(n in this.blobQueue)t=this.blobQueue[n],this.enQueueErrorBlocks(t.blob)},nextBlock:function(){var n,t;for(key in this.blobQueue)if(n=this.blobQueue[key],n.pointer<n.size)return t=new v(n),n.blocks.push(t),n.pointer+=t.size,t;return this.blockQueue.shift()},upload:function(){for(this.commitAll();r.maxThread==0||this.threads<r.maxThread;){var n=this.nextBlock();if(n!=null)n.upload(),this.threads++;else break}},commit:function(n){var r=n.blob.Url,t=[],f=n.blocks.length,e=n.blob.web,i;for(n.commiting=!0,t.push('<?xml version="1.0" encoding="utf-8"?><BlockList>'),i=0;i<f;i++)t.push("<Latest>"+n.blocks[i].id+"<\/Latest>");t.push("<\/BlockList>");e.request(r,"PUT",{comp:"blocklist"},{data:t.join(""),headers:{"Content-Type":", text/plain;charset=UTF-8"},success:function(){n.success&&(u.dequeueBlob(n.blob),n.success.apply(n.blob,arguments))},error:function(){n.commiting=!1;n.error&&n.error.apply(n.blob,arguments)}}).send()},commitAll:function(){for(n in this.pool){var t=this.pool[n];t.loaded!=t.size||t.commiting||this.commit(t)}}};w.blob=s}(jAzure,jQuery,window);